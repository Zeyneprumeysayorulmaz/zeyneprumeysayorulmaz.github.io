---
title: Jaeger Nedir? Jaeger Terminolojisi ve BileÅŸenleri | Distributed Tracing Nedir?
---

![]({{ 'assets/img/jaeger.png' | relative_url }})

Merhabalar, bu yazÄ±mda **Jaeger** Ã¼rÃ¼nÃ¼nden, terminolojisinden ve bileÅŸenlerinden beraberinde ise **Distributed Tracing** kavramÄ±ndan bahsedeceÄŸim.

Bunlara geÃ§meden Ã¶nce ise **OpenShift Cluster Monitoring** konusuna deÄŸinmek istiyorum.

![]({{ 'assets/img/openshiftclustermonitoring.png' | relative_url }})

Kubernetes ekosisteminde neredeyse standart olmuÅŸ projeler yer almaktadÄ±r. Bu noktada Prometheus neredeyse bir standart. OpenShift de bu standartlarÄ± kullanmakta.

Bu projeleri incelemek iÃ§in [CNCF Cloud Native Interactive Landscape]( https://landscape.cncf.io/), [Cloud Native Computing Foundation (cncf.io)](https://www.cncf.io/) adreslerine gÃ¶z atabilirsiniz. Burada Monitoring iÃ§in Prometheus, Thanos ve Grafana, Tracing iÃ§inse Jaeger ve OpenTelemetry karÅŸÄ±mÄ±za Ã§Ä±kÄ±yor.

Gelelim **OpenShift Monitoring** kÄ±smÄ±na,

Openshiftâ€™ i kurduÄŸumuz zaman beraberinde bir monitoring stack yapÄ±sÄ± gelmekte. UygulamalarÄ±, clusterâ€™ Ä±n kendi metriklerini, nodeâ€™larÄ±n vs. default metriklerini alÄ±p bir time series database de tutuyor. Prometheus burada metrikleri toplayan bir araÃ§ bunlarÄ±n dashboardlarÄ±nÄ± ise Grafana da gÃ¶rÃ¼ntÃ¼leyebiliyoruz. Burada aynÄ± zamanda alert/notification konfigÃ¼rasyonlarÄ±nÄ± da yine Prometheus Ã¼zerinden yapabiliyoruz. Bir OpenShift Clusterâ€™ Ä±na sahipseniz halihazÄ±rda geldiÄŸinden Cluster Monitor yapabiliyor olmalÄ±sÄ±nÄ±z.

Cluster Monitoringâ€™ in varsayÄ±lan olarak OpenShift ortamÄ±nÄ±zda bulunduÄŸundan bahsetmiÅŸtik. AynÄ± zamanda Horizontal Pod Autoscaling (HPA) iÃ§in resource metrikleri ortaya Ã§Ä±karmaktadÄ±r. Buradaki konfigÃ¼rasyonlarÄ± Config Maps ve Secrets aracÄ±lÄ±ÄŸÄ±yla yapabiliyoruz. OpenShift UI, Prometheus ve Thanosâ€™ a entegre olduÄŸundan direkt metrikleri Ã§ekmekte bÃ¶ylece Cluster Monitoring kÄ±smÄ±nda Alerting, Metrics ve Dashboard kÄ±sÄ±mlarÄ±nÄ± gÃ¶rebilirisiniz.

![]({{ 'assets/img/levelopenshiftmon.png' | relative_url }})

OpenShift Container Platformâ€™ da beraberinde gelen Monitoring iÃ§in karÅŸÄ±mÄ±za aslÄ±nda 2 level Ã§Ä±kÄ±yor. Level 0; pod ayakta veya down, Level 1; CPU veya Memory kaynaklarÄ± aynÄ± zamanda diÄŸer network metrikleri. HiÃ§ bir iÅŸlem yapmasanÄ±z bile bu seviyede OpenShift metrikleri toplamakta.

OpenShift Clusterâ€™ larda yer alan uygulamalarÄ±n metriklerini monitÃ¶r etmek istersek; uygulamanÄ±n bu metrikleri saÄŸlamasÄ± gerekmekte. OpenShift, Cluster Monitoringâ€™ in yanÄ± sÄ±ra bir de User Workload Monitoring Ã¶zelliÄŸi sunmaktadÄ±r. Bu da uygulama spesifik metrikleri toplayabiliriz demek ğŸ˜‰ Enable ettiÄŸimiz takdirde uygulama Ã¶zelinde konfigÃ¼rasyonlar yapabiliyoruz.

***Peki arka planda iÅŸler nasÄ±l yÃ¼rÃ¼yor?***

![]({{ 'assets/img/openshiftoperator.png' | relative_url }})

OpenShiftâ€™in cluster-monitoring-operatorâ€™Ã¼ bir prometheus-operator oluÅŸturuyor. Beraberinde Alertmanagerâ€™ Ä± kuruyor. cluster-monitoring-operator; Grafana, node-exporter vs gibi bir Ã§ok ÅŸeyi otomatik olarak oluÅŸturuyor. TÃ¼m bunlar openshift-monitoring namespaceâ€™i iÃ§inde Ã§alÄ±ÅŸÄ±yor.

![]({{ 'assets/img/openshiftoperator2.png' | relative_url }})

Her bir worker node Ã¼zerinde node-exporter Ã§alÄ±ÅŸÄ±yor. Podâ€™ larÄ±n metrikleri (OpenShiftâ€™in tÃ¼m componentleri pod olarak yaÅŸar) node-exporterâ€™ a atÄ±lÄ±yor. node-exporter bunu Prometheusâ€™ atÄ±yor. Grafana ile de biz tÃ¼m bu metrikleri izleyebiliyoruz.

## **OpenShift Distributed Tracing**

Distributed tracing, daÄŸÄ±tÄ±k uygulamalarÄ± izlememize ve takibini yapmamÄ±za olanak tanÄ±yan bir Ã§Ã¶zÃ¼m aslÄ±nda. OpenShift Distributed Tracing ise Jaegerâ€™ Ä±n RedHat tarafÄ±ndan desteklenen versiyonu ÅŸeklinde dÃ¼ÅŸÃ¼nebiliriz. AynÄ± zamanda Service Meshâ€™ in bir parÃ§asÄ± olarak kullanÄ±lÄ±yor. AyrÄ±ca stand-alone proje mikroservisleri Ã¶zelinde ilgili operatÃ¶rÃ¼n kurulmasÄ±yla bir yapÄ± saÄŸlayabiliyoruz. Burada iki mod karÅŸÄ±mÄ±za Ã§Ä±kÄ±yor. EÄŸer non-prod bir ortamdaysanÄ±z; her data iÃ§in trace istemeyebilir ve all-in-one memory ile her ÅŸeyi memory de tutabilirsiniz. Ya da prod bir ortamdaysanÄ±z; arkada elasticsearch operatÃ¶rÃ¼nÃ¼n baÄŸlanmasÄ±yla trace datasÄ±nÄ± elasticsearch Ã¼zerinde tutabilirsiniz.

Jaeger operatÃ¶rÃ¼ OpenShiftâ€™e kurulduktan sonra ilgili projelerin namespaceâ€™ inde jaeger instanceâ€™ Ä± yaratÄ±labilir ve bu jaeger instanceâ€™ Ä± ile mikroservisler arasÄ±ndaki mesajlaÅŸmayÄ± izleyebilirsiniz.

## **Jaeger Terminolojisi ve BileÅŸenleri**

![]({{ 'assets/img/jaegerterm.png' | relative_url }})

Jaeger tarafÄ±nda her bir istek Trace olarak adlandÄ±rÄ±lmakta ve bir iÅŸlemin akÄ±ÅŸÄ±nÄ± baÅŸtan sona gÃ¶stermektedir. Her trace birden fazla Spanâ€˜dan oluÅŸabilir. Her Span iÃ§erisinde iÅŸlemin adÄ±nÄ±, baÅŸlangÄ±Ã§ zamanÄ±nÄ±, sÃ¼resini, taglarÄ± ve loglarÄ± barÄ±ndÄ±rÄ±r. Bu deÄŸerler key-value ÅŸeklinde tutulur. Jaeger bu Spanâ€™larÄ± ve Traceâ€™leri toplamak, depolamak ve gÃ¶rselleÅŸtirmek iÃ§in birden fazla bileÅŸeni barÄ±ndÄ±rÄ±r.

**Agent:** Spanâ€™ leri dinlemek (UDP Ã¼zerinden gÃ¶nderilen spanleri dinler.) iÃ§in kullanÄ±lan bir servistir. Bu networkâ€™ de bir deamon olabilir. Toplanan spanlerâ€™ i collectorâ€™ e gÃ¶nderir. All-in-one memory kurmuÅŸsanÄ±z bu bir yere yazÄ±lmaz memoryâ€™ de tutulur. Jaegerâ€™ Ä± production stratejisi ile kurmuÅŸsanÄ±z toplanan span dataâ€™ sÄ±nÄ± ister Elasticsearchâ€™ e isterseniz Kafkaâ€™ ya yazabilirsiniz.

**Ingester:** EÄŸer arada bir Kafka kullanÄ±yorsanÄ±z burada span dataâ€™ larÄ±nÄ± Kafkaâ€™ da tutup oradan storage backendlere (Elasticsearch) yazabilirsiniz. Ingester bu iÅŸlem iÃ§in var olan bir componenttir.

**Query:** Storageâ€™ den traceleri getiren ve bunlarÄ± Jaeger UI ile izlememize olanak tanÄ±yan servistir.

FarklÄ± Jaeger clientâ€™ larÄ± olabilir. BunlarÄ±n hepsi iÃ§in OpenTracingAPI implement edilmelidir. Implementasyon saÄŸlandÄ±ÄŸÄ±nda, agent spanâ€™ leri toplar ve collectorâ€™ e gÃ¶nderir.

![]({{ 'assets/img/jaegeropenshift.png' | relative_url }})

   OpenShift Ã¼zerinde Jaeger kullanmak isterseniz;

   Bir Jaegerâ€™ Ä± tÃ¼m namespaceâ€™ ler iÃ§in kullanabilir ve tÃ¼m span dataâ€™ larÄ±nÄ± toplayabilirsiniz.

   Her namespace Ã¶zelinde bir Jaeger instanceâ€™ Ä± yaratabilirsiniz.

   Service Meshâ€™ in bir parÃ§asÄ± olarak da kullanabilirsiniz. Yine daha Ã¶nce bahsettiÄŸimiz gibi stand-alone olarak da kullanabilirsiniz.

Bir sonraki yazÄ±da gÃ¶rÃ¼ÅŸmek Ã¼zere ğŸ˜Š

![]({{ 'assets/img/microservices.png' | relative_url }})


*Referanslar:*

[What is Jaeger?] (https://www.redhat.com/en/topics/microservices/what-is-jaeger)

[Distributed tracing release notes](https://docs.openshift.com/container-platform/4.9/distr_tracing/distributed-tracing-release-notes.html)

[CNCF Cloud Native Interactive Landscape](https://landscape.cncf.io/)

[Cloud Native Computing Foundation (cncf.io)](https://www.cncf.io/)
